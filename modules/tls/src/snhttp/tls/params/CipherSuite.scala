package snhttp.tls.params

/// aka IANA TLS Cipher Suite Names
trait CipherSuiteName(val name: String)
/// OpenSSL Cipher Suite Names used in OpenSSL configuration
trait OpenSSLCipherSuiteName(val openSSLName: String)

private type CSName = CipherSuiteName
private type OCSName = OpenSSLCipherSuiteName

/// RFC 8446
/// Ported from https://www.iana.org/assignments/tls-parameters/tls-parameters.xhtml
/// Filtered by column "Recommended" with option "Y"
enum CipherSuite(val code: Int):
  // scalafmt: { maxColumn = 300 }
  case TLS_DHE_RSA_WITH_AES_128_GCM_SHA256 extends CipherSuite(0x009e) with CSName("TLS_DHE_RSA_WITH_AES_128_GCM_SHA256") with OCSName("DHE-RSA-AES128-GCM-SHA256")
  case TLS_DHE_RSA_WITH_AES_256_GCM_SHA384 extends CipherSuite(0x009f) with CSName("TLS_DHE_RSA_WITH_AES_256_GCM_SHA384") with OCSName("DHE-RSA-AES256-GCM-SHA384")
  case TLS_DHE_PSK_WITH_AES_128_GCM_SHA256 extends CipherSuite(0x00aa) with CSName("TLS_DHE_PSK_WITH_AES_128_GCM_SHA256") with OCSName("DHE-PSK-AES128-GCM-SHA256")
  case TLS_DHE_PSK_WITH_AES_256_GCM_SHA384 extends CipherSuite(0x00ab) with CSName("TLS_DHE_PSK_WITH_AES_256_GCM_SHA384") with OCSName("DHE-PSK-AES256-GCM-SHA384")

  case TLS_AES_128_GCM_SHA256 extends CipherSuite(0x1301) with CSName("TLS_AES_128_GCM_SHA256") with OCSName("TLS_AES_128_GCM_SHA256")
  case TLS_AES_256_GCM_SHA384 extends CipherSuite(0x1302) with CSName("TLS_AES_256_GCM_SHA384") with OCSName("TLS_AES_256_GCM_SHA384")
  case TLS_CHACHA20_POLY1305_SHA256 extends CipherSuite(0x1303) with CSName("TLS_CHACHA20_POLY1305_SHA256") with OCSName("TLS_CHACHA20_POLY1305_SHA256")
  case TLS_AES_128_CCM_SHA256 extends CipherSuite(0x1304) with CSName("TLS_AES_128_CCM_SHA256") with OCSName("TLS_AES_128_CCM_SHA256")

  case TLS_DHE_RSA_WITH_AES_128_CCM extends CipherSuite(0xc09e) with CSName("TLS_DHE_RSA_WITH_AES_128_CCM") with OCSName("DHE-RSA-AES128-CCM")
  case TLS_DHE_RSA_WITH_AES_256_CCM extends CipherSuite(0xc09f) with CSName("TLS_DHE_RSA_WITH_AES_256_CCM") with OCSName("DHE-RSA-AES256-CCM")
  case TLS_DHE_PSK_WITH_AES_128_CCM extends CipherSuite(0xc0a6) with CSName("TLS_DHE_PSK_WITH_AES_128_CCM") with OCSName("DHE-PSK-AES128-CCM")
  case TLS_DHE_PSK_WITH_AES_256_CCM extends CipherSuite(0xc0a7) with CSName("TLS_DHE_PSK_WITH_AES_256_CCM") with OCSName("DHE-PSK-AES256-CCM")

  case TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384 extends CipherSuite(0xc030) with CSName("TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384") with OCSName("ECDHE-RSA-AES256-GCM-SHA384")
  case TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256 extends CipherSuite(0xc02f) with CSName("TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256") with OCSName("ECDHE-RSA-AES128-GCM-SHA256")
  case TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384 extends CipherSuite(0xc02c) with CSName("TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384") with OCSName("ECDHE-ECDSA-AES256-GCM-SHA384")
  case TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256 extends CipherSuite(0xc02b) with CSName("TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256") with OCSName("ECDHE-ECDSA-AES128-GCM-SHA256")
  case TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305_SHA256 extends CipherSuite(0xcca8) with CSName("TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305_SHA256") with OCSName("ECDHE-RSA-CHACHA20-POLY1305")
  case TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305_SHA256 extends CipherSuite(0xcca9) with CSName("TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305_SHA256") with OCSName("ECDHE-ECDSA-CHACHA20-POLY1305")
  case TLS_DHE_RSA_WITH_CHACHA20_POLY1305_SHA256 extends CipherSuite(0xccaa) with CSName("TLS_DHE_RSA_WITH_CHACHA20_POLY1305_SHA256") with OCSName("DHE-RSA-CHACHA20-POLY1305")
  case TLS_ECDHE_PSK_WITH_CHACHA20_POLY1305_SHA256 extends CipherSuite(0xccac) with CSName("TLS_ECDHE_PSK_WITH_CHACHA20_POLY1305_SHA256") with OCSName("ECDHE-PSK-CHACHA20-POLY1305")
  case TLS_DHE_PSK_WITH_CHACHA20_POLY1305_SHA256 extends CipherSuite(0xccad) with CSName("TLS_DHE_PSK_WITH_CHACHA20_POLY1305_SHA256") with OCSName("DHE-PSK-CHACHA20-POLY1305")

  case TLS_ECDHE_PSK_WITH_AES_128_GCM_SHA256 extends CipherSuite(0xd001) with CSName("TLS_ECDHE_PSK_WITH_AES_128_GCM_SHA256") with OCSName("ECDHE-PSK-AES128-GCM-SHA256")
  case TLS_ECDHE_PSK_WITH_AES_256_GCM_SHA384 extends CipherSuite(0xd002) with CSName("TLS_ECDHE_PSK_WITH_AES_256_GCM_SHA384") with OCSName("ECDHE-PSK-AES256-GCM-SHA384")
  case TLS_ECDHE_PSK_WITH_AES_128_CCM_SHA256 extends CipherSuite(0xd005) with CSName("TLS_ECDHE_PSK_WITH_AES_128_CCM_SHA256") with OCSName("ECDHE-PSK-AES128-CCM-SHA256")
  // scalafmt: { maxColumn = 120 }

object CipherSuite:

  val ALL_SUPPORTED_CIPHER_SUITES = CipherSuite.values.toSet

  val TLS_v1_2_SUPPORTED_CIPHER_SUITES = Set(
    //////
    CipherSuite.TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256,
    CipherSuite.TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384,
    // CipherSuite.TLS_ECDHE_ECDSA_WITH_CAMELLIA_128_GCM_SHA256,
    // CipherSuite.TLS_ECDHE_ECDSA_WITH_ARIA_256_GCM_SHA384,
    // CipherSuite.TLS_ECDHE_ECDSA_WITH_ARIA_128_GCM_SHA256,
    CipherSuite.TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305_SHA256,
    // CipherSuite.TLS_ECDHE_ECDSA_WITH_CAMELLIA_256_GCM_SHA384,
    CipherSuite.TLS_ECDHE_PSK_WITH_AES_128_GCM_SHA256,
    CipherSuite.TLS_ECDHE_PSK_WITH_AES_256_GCM_SHA384,
    CipherSuite.TLS_ECDHE_PSK_WITH_CHACHA20_POLY1305_SHA256,
    // CipherSuite.TLS_ECCPWD_WITH_AES_128_GCM_SHA256,
    // CipherSuite.TLS_ECCPWD_WITH_AES_256_GCM_SHA384,
    // CipherSuite.TLS_ECDHE_RSA_WITH_ARIA_128_GCM_SHA256,
    // CipherSuite.TLS_ECCPWD_WITH_AES_256_CCM_SHA384,
    // CipherSuite.TLS_ECDHE_ECDSA_WITH_AES_256_CCM_8,
    // CipherSuite.TLS_ECDHE_ECDSA_WITH_AES_256_CCM,
    CipherSuite.TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384,
    CipherSuite.TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256,
    // CipherSuite.TLS_ECDHE_ECDSA_WITH_AES_128_CCM_8,
    // CipherSuite.TLS_ECDHE_ECDSA_WITH_AES_128_CCM,
    CipherSuite.TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305_SHA256,
    // CipherSuite.TLS_ECDHE_RSA_WITH_CAMELLIA_256_GCM_SHA384,
    // CipherSuite.TLS_ECDHE_RSA_WITH_CAMELLIA_128_GCM_SHA256,
    // CipherSuite.TLS_ECDHE_RSA_WITH_ARIA_256_GCM_SHA384,
    // CipherSuite.TLS_ECCPWD_WITH_AES_128_CCM_SHA256,
    CipherSuite.TLS_ECDHE_PSK_WITH_AES_128_CCM_SHA256,
    // CipherSuite.TLS_ECDHE_PSK_WITH_AES_128_CCM_8_SHA256,
  )

  val TLS_v1_3_ONLY_SUPPORTED_CIPHER_SUITES = Set(
    CipherSuite.TLS_AES_128_CCM_SHA256,
    CipherSuite.TLS_AES_128_GCM_SHA256,
    CipherSuite.TLS_AES_256_GCM_SHA384,
    CipherSuite.TLS_CHACHA20_POLY1305_SHA256,
  )

  val TLS_v1_3_ALL_SUPPORTED_CIPHER_SUITES = Set(
    CipherSuite.TLS_CHACHA20_POLY1305_SHA256,
    CipherSuite.TLS_AES_128_CCM_SHA256,
    // CipherSuite.TLS_AES_128_CCM_8_SHA256,
    CipherSuite.TLS_AES_128_GCM_SHA256,
    CipherSuite.TLS_AES_256_GCM_SHA384,
    CipherSuite.TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305_SHA256,
    // CipherSuite.TLS_ECDHE_ECDSA_WITH_CAMELLIA_256_GCM_SHA384,
    // CipherSuite.TLS_ECDHE_ECDSA_WITH_CAMELLIA_128_GCM_SHA256,
    // CipherSuite.TLS_ECDHE_ECDSA_WITH_ARIA_256_GCM_SHA384,
    // CipherSuite.TLS_ECDHE_ECDSA_WITH_ARIA_128_GCM_SHA256,
    CipherSuite.TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384,
    CipherSuite.TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256,
    // CipherSuite.TLS_ECDHE_ECDSA_WITH_AES_256_CCM_8,
    // CipherSuite.TLS_ECDHE_ECDSA_WITH_AES_256_CCM,
    // CipherSuite.TLS_ECDHE_ECDSA_WITH_AES_128_CCM,
    // CipherSuite.TLS_ECDHE_ECDSA_WITH_AES_128_CCM_8,
    CipherSuite.TLS_ECDHE_PSK_WITH_AES_128_GCM_SHA256,
    CipherSuite.TLS_ECDHE_PSK_WITH_AES_256_GCM_SHA384,
    CipherSuite.TLS_ECDHE_PSK_WITH_AES_128_CCM_SHA256,
    // CipherSuite.TLS_ECDHE_PSK_WITH_AES_128_CCM_8_SHA256,
    CipherSuite.TLS_ECDHE_PSK_WITH_CHACHA20_POLY1305_SHA256,
    // CipherSuite.TLS_ECCPWD_WITH_AES_256_GCM_SHA384,
    // CipherSuite.TLS_ECCPWD_WITH_AES_128_GCM_SHA256,
    // CipherSuite.TLS_ECCPWD_WITH_AES_128_CCM_SHA256,
    // CipherSuite.TLS_ECCPWD_WITH_AES_256_CCM_SHA384,
    // CipherSuite.TLS_ECDHE_RSA_WITH_CAMELLIA_256_GCM_SHA384,
    // CipherSuite.TLS_ECDHE_RSA_WITH_CAMELLIA_128_GCM_SHA256,
    // CipherSuite.TLS_ECDHE_RSA_WITH_ARIA_256_GCM_SHA384,
    // CipherSuite.TLS_ECDHE_RSA_WITH_ARIA_128_GCM_SHA256,
    CipherSuite.TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384,
    CipherSuite.TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256,
    CipherSuite.TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305_SHA256,
  )

end CipherSuite
